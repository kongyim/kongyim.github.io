(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8118:function(e,a,n){Promise.resolve().then(n.bind(n,2241))},2241:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return o}});var t=n(3827),i=n(4090);let l=["m","p","s","z","q"],s=(()=>{let e=[],a=(a,n,t)=>{for(let i=1;i<=n;i+=1)e.push({id:"Mpu".concat(i).concat(a),suit:a,value:i,maxCopies:t,name:"".concat(i).concat(a.toUpperCase()),path:"./tiles/Mpu".concat(i).concat(a,".png")})};return a("m",9,4),a("p",9,4),a("s",9,4),a("z",7,4),a("q",8,1),e})(),r=s.reduce((e,a)=>({...e,[a.id]:a}),{}),c=l.reduce((e,a)=>(e[a]=s.filter(e=>e.suit===a),e),{}),d=(e,a)=>{let n=r[e],t=r[a];if(!n||!t)return 0;let i=l.indexOf(n.suit)-l.indexOf(t.suit);return 0!==i?i:n.value-t.value};function o(){let[e,a]=(0,i.useState)([]),[s,o]=(0,i.useState)(!1),m=(0,i.useRef)(null),u=(0,i.useRef)(null),p=(0,i.useMemo)(()=>e.reduce((e,a)=>("tile"!==a.kind||(e[a.id]=(e[a.id]||0)+1),e),{}),[e]),h=e=>{let n=r[e];(p[e]||0)>=n.maxCopies||a(a=>[...a,{kind:"tile",id:e,uid:"tile-".concat(e,"-").concat(crypto.randomUUID?crypto.randomUUID():Math.random().toString(16).slice(2))}])},x=e=>{a(a=>a.filter((a,n)=>n!==e))},k=async()=>{if(m.current&&0!==g){o(!0),await new Promise(e=>setTimeout(e,0));try{let e=(await n.e(337).then(n.t.bind(n,2874,23))).default,a=await e(m.current,{backgroundColor:"#0f172a",scale:2}),t=document.createElement("a");t.download="mahjong-selection.png",t.href=a.toDataURL("image/png"),t.click()}finally{o(!1)}}},b=e.map((e,a)=>"spacer"===e.kind?{kind:"spacer",key:e.uid,index:a}:"newline"===e.kind?{kind:"newline",key:e.uid,index:a}:{...r[e.id],kind:"tile",key:e.uid,index:a}),g=e.filter(e=>"tile"===e.kind).length,j=e=>{u.current=e},f=e=>{let n=u.current;u.current=null,null!==n&&n!==e&&a(a=>{let t=[...a],[i]=t.splice(n,1);return t.splice(e,0,i),t})};return(0,t.jsxs)("main",{className:"main",children:[(0,t.jsx)("header",{className:"header",children:(0,t.jsx)("div",{children:(0,t.jsx)("h1",{className:"title",children:"Mahjong Tile Generator"})})}),(0,t.jsxs)("section",{className:"selector",children:[(0,t.jsxs)("div",{className:"tile-bar",children:[(0,t.jsxs)("h3",{children:["Selected tiles ",(0,t.jsx)("span",{className:"badge",children:g})]}),(0,t.jsx)("span",{className:"meta",children:"Drag to reorder. Sort uses Mahjong order: m → p → s → honors → flowers"})]}),(0,t.jsxs)("div",{className:"actions",style:{marginBottom:12},children:[(0,t.jsx)("button",{className:"btn ghost",onClick:()=>{a(e=>[...e,{kind:"spacer",uid:"spacer-".concat(crypto.randomUUID?crypto.randomUUID():Math.random().toString(16).slice(2))}])},"aria-label":"Add spacer",children:"Add spacer"}),(0,t.jsx)("button",{className:"btn ghost",onClick:()=>{a(e=>[...e,{kind:"newline",uid:"newline-".concat(crypto.randomUUID?crypto.randomUUID():Math.random().toString(16).slice(2))}])},"aria-label":"Add new line",children:"New line"})]}),(0,t.jsxs)("div",{ref:m,className:"selected-tiles".concat(s?" hide-spacers":""),"aria-live":"polite",onDragOver:e=>e.preventDefault(),onDrop:()=>f(b.length),children:[0===b.length&&(0,t.jsx)("p",{className:"notice",children:"Nothing yet—tap tiles below to add them."}),(()=>{let e=[],a=[];return b.forEach(n=>{"newline"===n.kind?(e.push({type:"tiles",items:a}),e.push({type:"newline",item:n}),a=[]):a.push(n)}),(a.length>0||0===e.length)&&e.push({type:"tiles",items:a}),e.map((e,a)=>{if("newline"===e.type){let a=e.item;return(0,t.jsx)("div",{className:"line-break clickable",onClick:()=>x(a.index),"aria-label":"Remove line break",title:"Click to remove line break",children:(0,t.jsx)("span",{className:"line-break-bar"})},a.key)}return(0,t.jsx)("div",{className:"selected-row",children:e.items.map(e=>(0,t.jsx)("button",{className:"tile clickable".concat("spacer"===e.kind?" spacer":""),onClick:()=>x(e.index),"aria-label":"spacer"===e.kind?"Remove spacer":"Remove ".concat(e.name),title:"spacer"===e.kind?"Click to remove spacer":"Click to remove this tile",draggable:!0,onDragStart:()=>j(e.index),onDragOver:e=>e.preventDefault(),onDrop:()=>f(e.index),children:"spacer"===e.kind?(0,t.jsx)("span",{className:"spacer-bar",children:(0,t.jsx)("img",{src:"./tiles/Mpu00.png"})}):(0,t.jsx)("img",{src:e.path,alt:e.name})},e.key))},"row-".concat(a))})})()]})]}),(0,t.jsx)("section",{children:(0,t.jsxs)("div",{className:"actions",children:[(0,t.jsx)("button",{className:"btn secondary",onClick:()=>{0!==g&&a(e=>{let a=e.filter(e=>"tile"===e.kind).sort((e,a)=>d(e.id,a.id)),n=0;return e.map(e=>{if("tile"!==e.kind)return e;let t=a[n];return n+=1,t})})},disabled:0===g,"aria-label":"Sort selected tiles",children:"Sort selection"}),(0,t.jsx)("button",{className:"btn",onClick:k,disabled:0===g,"aria-label":"Download selected tiles as image",children:"Download image"})]})}),(0,t.jsxs)("section",{style:{marginTop:24},children:[(0,t.jsxs)("div",{className:"tile-bar",style:{marginBottom:12},children:[(0,t.jsx)("h3",{children:"Tile catalog"}),(0,t.jsx)("span",{className:"meta",children:"Tap any tile to add it"})]}),(0,t.jsx)("div",{className:"catalog",children:l.map(e=>(0,t.jsx)("div",{className:"catalog-row",children:c[e].map(e=>{let a=(p[e.id]||0)>=e.maxCopies;return(0,t.jsx)("button",{className:"card tile-card".concat(a?" disabled":""),onClick:()=>h(e.id),disabled:a,"aria-label":"Add ".concat(e.name),title:a?"Reached max copies":"Add tile",children:(0,t.jsx)("img",{src:e.path,alt:e.name,loading:"lazy"})},e.id)})},e))})]})]})}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=8118)}),_N_E=e.O()}]);