(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8118:function(e,t,n){Promise.resolve().then(n.bind(n,2241))},2241:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(3827),i=n(4090);let l=["m","p","s","z","q"],r=(()=>{let e=[],t=(t,n,a)=>{for(let i=1;i<=n;i+=1)e.push({id:"Mpu".concat(i).concat(t),suit:t,value:i,maxCopies:a,name:"".concat(i).concat(t.toUpperCase()),path:"./tiles/Mpu".concat(i).concat(t,".png")})};return t("m",9,4),t("p",9,4),t("s",9,4),t("z",7,4),t("q",8,1),e})(),s=r.reduce((e,t)=>({...e,[t.id]:t}),{}),c=l.reduce((e,t)=>(e[t]=r.filter(e=>e.suit===t),e),{}),d=(e,t)=>{let n=s[e],a=s[t];if(!n||!a)return 0;let i=l.indexOf(n.suit)-l.indexOf(a.suit);return 0!==i?i:n.value-a.value};function o(){let[e,t]=(0,i.useState)([]),[r,o]=(0,i.useState)(0),[u,m]=(0,i.useState)(!1),p=(0,i.useRef)(null),h=(0,i.useRef)(null),k=(0,i.useRef)([]),b=(0,i.useMemo)(()=>e.reduce((e,t)=>("tile"!==t.kind||(e[t.id]=(e[t.id]||0)+1),e),{}),[e]),g=(0,i.useCallback)(e=>{t(t=>{let n="function"==typeof e?e(t):e;return n===t?t:(k.current.push(t),o(k.current.length),n)})},[]),x=e=>{let t=s[e];(b[e]||0)>=t.maxCopies||g(t=>[...t,{kind:"tile",id:e,uid:"tile-".concat(e,"-").concat(crypto.randomUUID?crypto.randomUUID():Math.random().toString(16).slice(2))}])},f=e=>{g(t=>t.filter((t,n)=>n!==e))},j=(0,i.useCallback)(()=>{t(e=>{if(0===k.current.length)return e;let t=k.current.pop();return o(k.current.length),t})},[]),N=async()=>{if(p.current&&0!==v){m(!0),await new Promise(e=>setTimeout(e,0));try{let e=(await n.e(337).then(n.t.bind(n,2874,23))).default,t=await e(p.current,{backgroundColor:"#0f172a",scale:2}),a=document.createElement("a");a.download="mahjong-selection.png",a.href=t.toDataURL("image/png"),a.click()}finally{m(!1)}}},y=e.map((e,t)=>"spacer"===e.kind?{kind:"spacer",key:e.uid,index:t}:"newline"===e.kind?{kind:"newline",key:e.uid,index:t}:{...s[e.id],kind:"tile",key:e.uid,index:t}),v=e.filter(e=>"tile"===e.kind).length;(0,i.useEffect)(()=>{let e=e=>{if(!(e instanceof HTMLElement))return!1;let t=e.tagName;return e.isContentEditable||"INPUT"===t||"TEXTAREA"===t||"SELECT"===t},t=t=>{("Backspace"===t.key||"Delete"===t.key)&&0!==k.current.length&&(e(t.target)||(t.preventDefault(),j()))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[j]);let w=e=>{h.current=e},C=e=>{let t=h.current;h.current=null,null!==t&&t!==e&&g(n=>{let a=[...n],[i]=a.splice(t,1);return a.splice(e,0,i),a})};return(0,a.jsxs)("main",{className:"main",children:[(0,a.jsx)("header",{className:"header",children:(0,a.jsx)("div",{children:(0,a.jsx)("h1",{className:"title",children:"Mahjong Tile Generator"})})}),(0,a.jsxs)("section",{className:"selector",children:[(0,a.jsxs)("div",{className:"tile-bar",children:[(0,a.jsxs)("h3",{children:["Selected tiles ",(0,a.jsx)("span",{className:"badge",children:v})]}),(0,a.jsx)("span",{className:"meta",children:"Drag to reorder. Sort uses Mahjong order: m → p → s → honors → flowers"})]}),(0,a.jsxs)("div",{className:"actions",style:{marginBottom:12},children:[(0,a.jsx)("button",{className:"btn ghost",onClick:()=>{g(e=>[...e,{kind:"spacer",uid:"spacer-".concat(crypto.randomUUID?crypto.randomUUID():Math.random().toString(16).slice(2))}])},"aria-label":"Add spacer",children:"Add spacer"}),(0,a.jsx)("button",{className:"btn ghost",onClick:()=>{g(e=>[...e,{kind:"newline",uid:"newline-".concat(crypto.randomUUID?crypto.randomUUID():Math.random().toString(16).slice(2))}])},"aria-label":"Add new line",children:"New line"}),(0,a.jsx)("button",{className:"btn ghost",onClick:j,disabled:0===r,"aria-label":"Undo last action",children:"Undo"})]}),(0,a.jsxs)("div",{ref:p,className:"selected-tiles".concat(u?" hide-spacers":""),"aria-live":"polite",onDragOver:e=>e.preventDefault(),onDrop:()=>C(y.length),children:[0===y.length&&(0,a.jsx)("p",{className:"notice",children:"Nothing yet—tap tiles below to add them."}),(()=>{let e=[],t=[];return y.forEach(n=>{"newline"===n.kind?(e.push({type:"tiles",items:t}),e.push({type:"newline",item:n}),t=[]):t.push(n)}),(t.length>0||0===e.length)&&e.push({type:"tiles",items:t}),e.map((e,t)=>{if("newline"===e.type){let t=e.item;return(0,a.jsx)("div",{className:"line-break clickable",onClick:()=>f(t.index),"aria-label":"Remove line break",title:"Click to remove line break",children:(0,a.jsx)("span",{className:"line-break-bar"})},t.key)}return(0,a.jsx)("div",{className:"selected-row",children:e.items.map(e=>(0,a.jsx)("button",{className:"tile clickable".concat("spacer"===e.kind?" spacer":""),onClick:()=>f(e.index),"aria-label":"spacer"===e.kind?"Remove spacer":"Remove ".concat(e.name),title:"spacer"===e.kind?"Click to remove spacer":"Click to remove this tile",draggable:!0,onDragStart:()=>w(e.index),onDragOver:e=>e.preventDefault(),onDrop:()=>C(e.index),children:"spacer"===e.kind?(0,a.jsx)("span",{className:"spacer-bar",children:(0,a.jsx)("img",{src:"./tiles/Mpu00.png"})}):(0,a.jsx)("img",{src:e.path,alt:e.name})},e.key))},"row-".concat(t))})})()]})]}),(0,a.jsx)("section",{children:(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsx)("button",{className:"btn secondary",onClick:()=>{0!==v&&g(e=>{let t=e.filter(e=>"tile"===e.kind).sort((e,t)=>d(e.id,t.id)),n=0;return e.map(e=>{if("tile"!==e.kind)return e;let a=t[n];return n+=1,a})})},disabled:0===v,"aria-label":"Sort selected tiles",children:"Sort selection"}),(0,a.jsx)("button",{className:"btn",onClick:N,disabled:0===v,"aria-label":"Download selected tiles as image",children:"Download image"})]})}),(0,a.jsxs)("section",{style:{marginTop:24},children:[(0,a.jsxs)("div",{className:"tile-bar",style:{marginBottom:12},children:[(0,a.jsx)("h3",{children:"Tile catalog"}),(0,a.jsx)("span",{className:"meta",children:"Tap any tile to add it"})]}),(0,a.jsx)("div",{className:"catalog",children:l.map(e=>(0,a.jsx)("div",{className:"catalog-row",children:c[e].map(e=>{let t=(b[e.id]||0)>=e.maxCopies;return(0,a.jsx)("button",{className:"card tile-card".concat(t?" disabled":""),onClick:()=>x(e.id),disabled:t,"aria-label":"Add ".concat(e.name),title:t?"Reached max copies":"Add tile",children:(0,a.jsx)("img",{src:e.path,alt:e.name,loading:"lazy"})},e.id)})},e))})]})]})}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=8118)}),_N_E=e.O()}]);